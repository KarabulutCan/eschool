@model ESCHOOL.ViewModels.StudentViewModel
@{
    System.Globalization.CultureInfo.CurrentCulture = System.Globalization.CultureInfo.CreateSpecificCulture(@Model.SelectedCulture);
    System.Globalization.CultureInfo.CurrentUICulture = System.Globalization.CultureInfo.CreateSpecificCulture(@Model.SelectedCulture);
    var culture = System.Globalization.CultureInfo.CurrentCulture.ToString();
}
@addTagHelper *, Kendo.Mvc

@{
    var messages = new Dictionary<string, string>() { { "custom", "Please choose another Start Time." } };
    var rules = new Dictionary<string, string>() { { "custom", "customFunction" } };
}
<!--#region head -->
<html>
<head>
    <style>
        html {
            font-size: 13px;
            font-family: Arial, Helvetica, sans-serif;
        }
    </style>
    <title></title>
    <link href="https://kendo.cdn.telerik.com/2021.2.616/styles/kendo.common.min.css" rel="stylesheet" />
    <link rel="stylesheet" id="skin-css" href="@TempData["theme"]" />
    <link rel="stylesheet" id="skin-css" href="@TempData["themeMobile"]" />
    <script src="https://kendo.cdn.telerik.com/2021.2.616/js/jquery.min.js"></script>
    <script src="https://kendo.cdn.telerik.com/2021.2.616/js/kendo.all.min.js"></script>

    <script src="@Url.Content("~/telerik/2021.2.616/js//cultures/kendo.culture." + culture + ".min.js")"></script>
    <script src="@Url.Content("~/telerik/2021.2.616/js//messages/kendo.messages." + culture + ".min.js")"></script>

    <script type="text/javascript">
        kendo.culture("@culture");
    </script>
</head>
<!--#endregion -->
<body data-spy="scroll" data-target=".navbar">
    @if (ViewBag.IsSuccess == true)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>@ESCHOOL.Resources.Resource.Warning</strong>@ESCHOOL.Resources.Resource.ValidationError<br />
            <a asp-contoller="M300Collections" asp-action="Collections" asp-route-id="@Model.UserID&@Model.StudentID">@ESCHOOL.Resources.Resource.ClickToContinue</a>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    }

    @*Notification*@
    <span id="popupNotification"></span>
    <span id="staticNotification"></span>
    <div id="popup" style="display: none;">
        <br /><br /><br />
        <div id="appendto"></div>
    </div>
    <script>
        var popupNotification = $("#popupNotification").kendoNotification().data("kendoNotification");

        function showPopupNotification() {
            var popupNotification = $("#popupNotification").kendoNotification().data("kendoNotification");
            var d = new Date();
            popupNotification.show(kendo.toString(d, 'HH:MM:ss.') + kendo.toString(d.getMilliseconds(), "000"), "error");
        };
    </script>

    <script>
        var staticNotification = $("#staticNotification").kendoNotification({
            appendTo: "#appendto",
            position: { top: 60, left: 70 },

        }).data("kendoNotification");
        function showStaticNotification(msg1, msg2, msg3, period, amount) {
            $("#popup").show(500);
            staticNotification.show(msg1 + kendo.toString(amount, 'n') + msg2 + msg3, "info");
            var container = $(staticNotification.options.appendTo);
            container.scrollTop(container[0].scrollHeight);
            closepopup();
        };
    </script>
    <script>
        function closepopup() {
            setTimeout(function () {
                $("#popup").hide(500);
            }, 5000);
        }
    </script>

    <form id="M300Collections" asp-controller="M300Collections" asp-action="Collections" asp-route-id="@Model.SchoolID&@Model.StudentID" enctype="multipart/form-data" method="post">
        <div class="demo-section k-content fixed-top wide">
            <div id="toolbarMenu"></div>
        </div>
        <br />

        <script>
            $(document).ready(function () {
                $("#switch2").kendoSwitch();
                $("form").submit(function (e) {
                    e.preventDefault();
                    $("#switch2").data("kendoSwitch").toggle();
                    document.getElementById("refreshId").disabled = true;
                });
            });

            $(document).ready(function () {
                $("#switch22").kendoSwitch();
                $("form").submit(function (e) {
                    e.preventDefault();
                    $("#switch22").data("kendoSwitch").toggle();
                    document.getElementById("refreshId").disabled = true;
                });
            });
        </script>

        <script id="template" type="text/x-kendo-template">
            <button id="refreshId" class="k-button" type="submit" onclick="return studentsRefresh()"  disabled><i class="k-icon k-i-reload"></i></button>
            <span class="k-textbox k-grid-search k-display-flex"  style="width:140px;">
                <input autocomplete="off" placeholder=@ESCHOOL.Resources.Resource.Search class="k-input">
                <span class="k-input-icon">
                    <span class="k-icon k-i-search" style="float:right"></span>
                </span>
            </span>

            <div class="toolbar" style="float:left"><label  for="paymentDropDown"></label> <input type="select" id="paymentDropDown" style="width: 100px" /></div >
            <div class="toolbar" title=@ESCHOOL.Resources.Resource.Period3 style="float:right"><label class="switch-label control-label" for="switch1"></label><input type="checkbox" class="kendo-switch" id="switch1" aria-label="switch1" data-change="onChange"/></div>
            <div title=@ESCHOOL.Resources.Resource.Siblings style="float:right"><label class="switch-label control-label" for="switch2"></label><input type="checkbox" class="kendo-switch" id="switch2" aria-label="switch2" data-change="onChange"/></div>
        </script>
        <script id="templateSibling" type="text/x-kendo-template">
            <span class="k-textbox k-grid-search k-display-flex"  style="width:auto;">
                <input autocomplete="off" placeholder=@ESCHOOL.Resources.Resource.Search class="k-input">
                <span class="k-input-icon">
                    <span class="k-icon k-i-search" style="float:right"></span>
                </span>
            </span>
            <div class="toolbar" style="float:left"><label>@ESCHOOL.Resources.Resource.Siblings</label></div >
            <div style="float:right"><label class="switch-label control-label" for="switch22"></label><input type="checkbox" class="kendo-switch" id="switch22" aria-label="switch22" data-change="onChange"/></div>
            <div class="toolbar" style="float:left"><label>@ESCHOOL.Resources.Resource.MonthTotal</label></div >
        </script>

@*                 <br /><br /><br /><br />*@
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
        <!--#region hidden -->
        @*Geri dönüşlerde null olmaması için*@
        <input type="hidden" asp-for="@Model.Student.StudentID" />
        <input type="hidden" asp-for="@Model.StudentID" />
        <input type="hidden" asp-for="@Model.UserID" />
        <input type="hidden" asp-for="@Model.Period" />
        <input type="hidden" asp-for="@Model.Student.SchoolID" />
        <input type="hidden" asp-for="@Model.SchoolID" />
        <input type="hidden" asp-for="@Model.Student.SiblingID" />
        <input type="hidden" asp-for="@Model.PSerialNumber.PSerialNumberID" />

        <input type="hidden" asp-for="@TempData["studentID"]" id="studentID" />
        
        <input type="hidden" id="selectedAmount" />
        <input type="hidden" id="installmentID" />
        <input type="hidden" id="dateID" />
        <input type="hidden" id="total" />
        <input type="hidden" id="debt" />
        <input type="hidden" id="maxTotal" />
        <input type="hidden" id="receiptNo" />
        <input type="hidden" id="categoryName" />
        <input type="hidden" id="switchId1" />
        <input type="hidden" id="switchId2" />
        <input type="hidden" id="switchId22" />
        <input type="hidden" id="resultOnOff" value="false" />

        <!--#endregion -->
        <br /> <br />
        <!--#region panelbarHelp -->
        <ul id="panelbarHelp" style="display: none;">
            <li>
                <span class="k-link">@ESCHOOL.Resources.Resource.Help</span>
                <div class="k-card-body" style="padding-left:15px;">
                    <p><strong>@ESCHOOL.Resources.Resource.CollectionMsg</strong></p>
                    <p>@ESCHOOL.Resources.Resource.CollectionMsg1</p>
                    <p>@ESCHOOL.Resources.Resource.CollectionMsg2</p>
                    <p>@ESCHOOL.Resources.Resource.CollectionMsg3</p>
                    <p>@ESCHOOL.Resources.Resource.CollectionMsg4</p>
                    <br />
                </div>
                <style>
                    #panelbarHelp {
                        width: 100%;
                        /*     max-width: none;*/
                        margin: 0 auto;
                    }
                </style>

                <script>
                    $(document).ready(function () {
                        $("#panelbarHelp").kendoPanelBar({
                            animation: {
                                collapse: {
                                    duration: 500,
                                    effects: "fadeOut"
                                },
                                expand: {
                                    duration: 500,
                                    effects: "expandVertical fadeIn"
                                }
                            }
                        });
                    });
                </script>
            </li>
        </ul>
        <!--#endregion -->

        <div class="row" style="border: thin solid rgb(120,120,120); padding-top:10px; padding-bottom:10px;">
            <section class="col order-1 col-md-5">
                <div id="siblings" style="display: none; height:180px;">
                    <div id="gridSiblings"></div>
                </div>
                <div>
                    <div id="gridStudents"></div>
                </div>
                <div id="periods" style="display: none; height:90px;">
                    <div id="gridStudentPeriods"></div>
                </div>
                <style>
                    #gridSiblings td {
                        padding: 0px;
                    }

                    #gridSiblings .k-grid-content {
                        height: 90px;
                        max-height: 90px;
                    }

                    #gridStudentPeriods td {
                        padding: 0px;
                    }

                    #gridStudentPeriods .k-grid-content {
                        height: 60px;
                        max-height: 60px;
                    }
                </style>
                <div class="row leftAlign" style="float: left; padding-left: 15px;height:20px;">
                    <p>
                        <button type="button" id="newid" style="width:100px;" onclick="newShow1()">@ESCHOOL.Resources.Resource.New2</button>
                    </p>
                    <p>
                        <button type="button" id="divideid" style="width:100px;" onclick="newShow2()">@ESCHOOL.Resources.Resource.DivideAmount</button>
                    </p>
                    <p>
                        <button type="button" id="changeid" style="width:100px;" onclick="newShow3()">@ESCHOOL.Resources.Resource.Change</button>
                    </p>
                </div>
                <script>
                    $(document).ready(function () {
                        $("#newid").kendoButton({
                            icon: "plus"
                        });
                        $("#divideid").kendoButton({
                            icon: "table-cell-delete"
                        });
                        $("#changeid").kendoButton({
                            icon: "arrows-no-change"
                        });
                        $("#closeid").kendoButton({
                            icon: "close"
                        });
                    });
                </script>
            </section>

            <div class="col k-content order-2 col-md-2 ra-well-title card-header">
                <div class="col" id="center">
                    <div id="wrap" class="row" style="height:8rem; width: 8rem; position:center">
                        <div class="card">
                            <img id="imgpreviewStudent" name="imgStudent" src="@("~/Upload/Students/default.png")" asp-append-version="true" class="img-fluid img-thumbnail" />
                        </div>
                    </div>
                </div>
                <hr class="space-1" />
                <div>
                    <ul id="fieldlist">
                        <li>
                            <label>@ESCHOOL.Resources.Resource.StudentName</label>
                            <input id="name" style="text-align: center" disabled />
                        </li>

                        <li>
                            <label>@ESCHOOL.Resources.Resource.RegistrationStatus</label>
                            <input id="statuCategory" style="text-align: center" disabled />
                        </li>
                        <li>
                            <input id="registrationTypeCategory" style="text-align: center" disabled />
                        </li>
                        <li>
                            <input id="dateOfRegistration" style="text-align: center" disabled />
                        </li>
                        <hr class="space-1" />
                        <li>
                            <div class="row" style="height:28px; border: thin solid lightgray; padding-right: 2px; padding-left: 2px;">
                                <label class="control-label">&nbsp;&nbsp;@ESCHOOL.Resources.Resource.Collection:&nbsp;</label>
                                <div>
                                    <input asp-for="StudentInstallment.AccountReceiptNo" id="receiptNoId" class="k-textbox" type="number" style="width:110px; height:22px;" placeholder=@ESCHOOL.Resources.Resource.AccountReceiptNo2 disabled />
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <hr class="space-1" />

                <hr class="space-1" />
                <div>
                    <hr class="space-1" />
                    <div class="row" style="margin-left:0px; height: 20px; padding-top:10px;">
                        <div class="row centerAlign">
                            <p>
                                <button type="button" id="calculator" style="width:66px; font-size:12px;" onclick="window.open('Calculator:///', '_blank', 'noreferrer')">@ESCHOOL.Resources.Resource.Calculator1</button>
                            </p>
                            <p>
                                <button type="button" id="cancel" style="width: 60px; font-size: 12px;">@ESCHOOL.Resources.Resource.Delete1</button>
                            </p>
                            <p>
                                <button type="button" id="printer" onclick="paymentPrinter()" style="width: 63px; font-size: 12px;">@ESCHOOL.Resources.Resource.Printer1</button>
                            </p>
                        </div>
                        <script>
                            $(document).ready(function () {
                                $("#calculator").kendoButton({
                                    icon: "calculator"
                                });
                                $("#cancel").kendoButton({
                                    icon: "delete"
                                });
                                $("#printer").kendoButton({
                                    icon: "printer"
                                });

                            });
                        </script>
                    </div>
                </div>
            </div>

            <section class="col order-3 col-md-5">
                <div id="gridFees"></div>
                <style>
                    #gridFees td {
                        padding: 2px;
                    }
                </style>

                <div class="form-horizontal k-content" style="padding-bottom:20px;">
                    <div class="card-body" style="padding-left:20px;">
                        <div class="row">
                            <div class="col col-md-4">
                                <label asp-for="StudentTemp.TransactionDate" class="control-label"></label>
                            </div>
                            <div class="col col-md-6">
                                <input type="date" id="transactiondate1" class="form-control" style="height:26px; width: 130px;" />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.CheckNo</label>
                            </div>
                            <div class="col col-md-6" style="padding-top:3px;">
                                <input id="checkNo1" class="k-textbox" style="height:26px; width: 270px;" readonly />
                                <input type="hidden" id="insID1" class="k-textbox" style="width: 270px;" readonly />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.PaymentAmount</label>
                            </div>
                            <div class="col col-md-6" style="padding-top:1px;">
                                <input id="installmentAmount1" class="k-textbox" type="number" min="0" style="height:26px; width: 130px;" value="0" />
                            </div>
                        </div>

                        <div class="row  float-left">
                            <div class="col col-md-7">
                                <label class="control-label" for="showdept" style="font-size:12px;">@ESCHOOL.Resources.Resource.ShowDebt</label>
                                <input asp-for="StudentTemp.IsShowDept" id="showdept" type='checkbox' class="k-checkbox" />
                            </div>

                            <div class="col col-md-3" style="padding-left:20px;">
                                <label class="control-label" style="font-size:12px;">@ESCHOOL.Resources.Resource.ReceiptNo</label>
                            </div>
                            <div class="col col-md-2" style="padding-right:2px; padding-bottom:2px;">
                                <input id="receiptId" class="k-textbox" style="height:26px; width: 70px;" maxlength="15" />
                            </div>
                        </div>

                    </div>
                </div>

                <div>
                    <div style="float:left; color:red">
                        <input asp-for="SchoolInfo.IsFormPrint" id="isFormPrint" type='checkbox' class="k-checkbox" />
                        <label class="control-label" for="isFormPrint" style="font-size:12px;">@ESCHOOL.Resources.Resource.Receipt</label>
                    </div>
                    <div class="row" style="float:right; margin-right:15px; height:20px;">
                        <p>
                            <button type="button" id="cancelid" style="width:100px;" onclick="cancelPayment2()">@ESCHOOL.Resources.Resource.Cancel</button>
                        </p>
                        <p>
                            <button type="button" id="okButtonid" style="width:100px;" onclick="paymentAddControl()">@ESCHOOL.Resources.Resource.Okey</button>
                        </p>
                        <p>
                            <button type="button" id="printerid" style="width:100px;" onclick="paymentSave()">@ESCHOOL.Resources.Resource.Printer2</button>
                        </p>
                    </div>

                    <script>
                        $(document).ready(function () {
                            $("#cancelid").kendoButton({
                                icon: "cancel"
                            });
                            $("#okButtonid").kendoButton({
                                icon: "check"
                            });
                            $("#submitid").kendoButton({
                                icon: "check"
                            });
                            $("#printerid").kendoButton({
                                icon: "printer"
                            });
                        });
                    </script>
                </div>
            </section>

        </div>
        <hr class="space-1" />


        <div id="div1" class="form-horizontal k-content  row" style="display: none; border: thin solid rgb(120,120,120)">
            <div class="col col-md-5">
                <div class="container-flued">
                    <div class="card-body">
                        <h5 class="ra-well-title card-header top-left">
                            <kbd>@ESCHOOL.Resources.Resource.NewInstallmentRegistration</kbd>
                        </h5>
                        <br />
                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.Fees</label>
                            </div>
                            <div class="col col-md-6">
                                <input id="feeDropDown" style="width: 150px;" />
                            </div>

                            <div class="col col-md-2">
                                <div class="row rightAlign" style="float: right; margin-right: 1px; ">
                                    <p>
                                        <button type="button" id="okButton1" style="width:80px;" onclick="div1Button()">@ESCHOOL.Resources.Resource.Okey</button>
                                    </p>
                                </div>
                                <script>
                                    $(document).ready(function () {
                                        $("#okButton1").kendoButton({
                                            icon: "check",
                                        });
                                    });
                                </script>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.PaymentAmount</label>
                            </div>
                            <div class="col col-md-6">
                                <input id="amount1" class="k-textbox" type="number" min="0" style="width: 150px;" value="0" />
                            </div>
                            <div class="col col-md-2">
                                <div class="row rightAlign" style="float: right; margin-right: 1px; ">
                                    <span class="k-card-action"><span class="k-button k-flat k-primary" id="closeid" style="height: 30px; width: 80px" onclick="newShow4()">@ESCHOOL.Resources.Resource.Close</span></span>
                                </div>
                                <script>
                                    $(document).ready(function () {
                                        $("#closeid").kendoButton({
                                            icon: "close",
                                        });
                                    });
                                </script>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.PaymentDate2</label>
                            </div>
                            <div class="col col-md-6">
                                <input type="date" id="date1" class="form-control" style="height:28px; width: 150px;" />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.PaymentType</label>
                            </div>
                            <div class="col col-md-6">
                                <input id="paymentDropDown1" class="paymentDropDown" style="width: 150px;" />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.BankName</label>
                            </div>
                            <div class="col col-md-6">
                                <input id="bankNameDropDown1" class="bankNameDropDown" style="width: 250px;" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="div11" class="col col-md-7" style="border: thin solid rgb(120,120,120);">
                <div class="container-flued">

                    <div class="k-card-body">
                        <br /><br />
                        <p><strong>@ESCHOOL.Resources.Resource.Explanation</strong></p>
                        <p>@ESCHOOL.Resources.Resource.Div1Msg1</p>
                        <p>@ESCHOOL.Resources.Resource.Div1Msg2</p>
                    </div>

                </div>
            </div>
        </div>

        <div id="div2" class="form-horizontal k-content  row" style="display: none; border: thin solid rgb(120,120,120)">
            <div class="col col-md-5">
                <div class="container-flued">
                    <div class="card-body">
                        <h5 class="ra-well-title card-header top-left">
                            <kbd>@ESCHOOL.Resources.Resource.DividingInstallmentAmount</kbd>
                        </h5>
                        <br />
                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label" id="dividedAmount">@ESCHOOL.Resources.Resource.DividedAmount</label>
                            </div>
                            <div class="col col-md-6">
                                <input id="amount2" class="k-textbox" type="number" min="0" style="width: 150px;" value="0" />
                            </div>

                            <div class="col col-md-2">
                                <div class="row rightAlign" style="float: right; margin-right: 1px; ">
                                    <p>
                                        <button type="button" id="okButton2" style="width:80px" onclick="div2Button()">@ESCHOOL.Resources.Resource.Okey</button>
                                    </p>
                                </div>

                                <script>
                                    $(document).ready(function () {
                                        $("#okButton2").kendoButton({
                                            icon: "check",
                                        });
                                    });
                                </script>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col col-md-4">
                                <hr />
                            </div>
                            <div class="col col-md-6">
                                <label class="control-label" style="color:red; font-weight:bold;">@ESCHOOL.Resources.Resource.SinglePayment2</label>
                            </div>
                            <div class="col col-md-2">
                                <div class="row rightAlign" style="float: right; margin-right: 1px; ">
                                    <span class="k-card-action"><span class="k-button k-flat k-primary" id="closeid" style="height: 30px; width: 80px" onclick="newShow4()">@ESCHOOL.Resources.Resource.Close</span></span>
                                </div>
                                <script>
                                    $(document).ready(function () {
                                        $("#closeid").kendoButton({
                                            icon: "close",
                                        });
                                    });
                                </script>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col col-md-10">
                                <label class="control-label">@ESCHOOL.Resources.Resource.SinglePayment</label>
                            </div>
                            <div id="singlePaymentDiv" class="col col-md-2">
                                <input id="singlePayment" type='checkbox' class="k-checkbox" data-bind="checked: boxChecked, events: { change: GetCheck } " />
                            </div>
                        </div>
                        <hr />
                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.PaymentDate2</label>
                            </div>
                            <div class="col col-md-6">
                                <input type="date" id="date2" class="form-control" style="width: 150px;" />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.PaymentType</label>
                            </div>
                            <div class="col col-md-6">
                                <input id="paymentDropDown2" class="paymentDropDown" style="width: 150px;" />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.BankName</label>
                            </div>
                            <div class="col col-md-6">
                                <input id="bankNameDropDown2" class="bankNameDropDown" style="width: 250px;" />
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div id="div22" class="col col-md-7" style="border: thin solid rgb(120,120,120)">
                <div class="container-flued">
                    <div class="k-card-body">
                        <br /><br />
                        <p><strong>@ESCHOOL.Resources.Resource.Explanation</strong></p>
                        <p>@ESCHOOL.Resources.Resource.Div2Msg1</p>
                        <p>@ESCHOOL.Resources.Resource.Div2Msg2</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="div3" class="form-horizontal k-content  row" style="display: none; border: thin solid rgb(120,120,120)">
            <div class="col col-md-5">
                <div class="container-flued">
                    <div class="card-body">
                        <h5 class="ra-well-title card-header top-left">
                            <kbd>@ESCHOOL.Resources.Resource.ChangingInstallmentType</kbd>
                        </h5>
                        <br />
                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.PaymentDate2</label>
                            </div>
                            <div class="col col-md-6">
                                <input type="date" id="date3" class="form-control" style="width: 150px;" />
                            </div>

                            <div class="col col-md-2">
                                <div class="row rightAlign" style="float: right; margin-right: 1px; ">
                                    <p>
                                        <button type="button" id="okButton3" style="width:80px" onclick="div3Button()">@ESCHOOL.Resources.Resource.Okey</button>
                                    </p>
                                </div>

                                <script>
                                    $(document).ready(function () {
                                        $("#okButton3").kendoButton({
                                            icon: "check",
                                        });
                                    });
                                </script>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.PaymentType</label>
                            </div>
                            <div class="col col-md-6">
                                <input id="paymentDropDown3" class="paymentDropDown" style="width: 150px;" />
                            </div>
                            <div class="col col-md-2">
                                <div class="row rightAlign" style="float: right; margin-right: 1px; ">
                                    <span class="k-card-action"><span class="k-button k-flat k-primary" id="closeid" style="height: 30px; width: 80px" onclick="newShow4()">@ESCHOOL.Resources.Resource.Close</span></span>
                                </div>
                                <script>
                                    $(document).ready(function () {
                                        $("#closeid").kendoButton({
                                            icon: "close",
                                        });
                                    });
                                </script>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.BankName</label>
                            </div>
                            <div class="col col-md-6">
                                <input id="bankNameDropDown3" class="bankNameDropDown" style="width: 250px;" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col col-md-4">
                                <label class="control-label">@ESCHOOL.Resources.Resource.NewNumber</label>
                            </div>
                            <div class="col col-md-2">
                                <input id="newNumber" type='checkbox' class="k-checkbox" checked="checked" />
                            </div>
                        </div>


                    </div>

                </div>
            </div>
            <div id="div33" class="col col-md-7" style="border: thin solid rgb(120,120,120)">
                <div class="container-flued">
                    <div class="k-card-body">
                        <br /><br />
                        <p><strong>@ESCHOOL.Resources.Resource.Explanation</strong></p>
                        <p>@ESCHOOL.Resources.Resource.Div3Msg1</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="div4" class="form-horizontal k-content  row" style="display: none; border: thin solid rgb(120,120,120)">
            <div id="div44" class="col col-md-6">
                <div class="container-flued">
                    <div class="k-card-body">
                        <br /><br />
                        <p><strong>@ESCHOOL.Resources.Resource.Explanation</strong></p>
                        <p>@ESCHOOL.Resources.Resource.Div4Msg1</p>
                        <p>@ESCHOOL.Resources.Resource.Div4Msg2</p>
                    </div>
                </div>
            </div>
            <div class="col col-md-6" style="border: thin solid rgb(120,120,120)">
                <div class="container-flued">
                    <div class="card-body">
                        <h5 class="ra-well-title card-header top-left">
                            <kbd>@ESCHOOL.Resources.Resource.AccountingTransactions</kbd>
                        </h5>
                        <br />
                        <div class="row">
                            <div class="col col-md-3">
                                <label class="control-label">@ESCHOOL.Resources.Resource.AccountCode</label>
                            </div>
                            <div class="col col-md-7">
                                <input id="accountCode" class="Accounting" asp-for="StudentTemp.AccountCode" style="width: 100%;" />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col col-md-3">
                                <label asp-for="StudentTemp.AccountExplanation" class="control-label">@ESCHOOL.Resources.Resource.Explanation</label>
                            </div>
                            <div class="col col-md-7">
                                <input asp-for="StudentTemp.AccountExplanation" id="accountExplanation" class="k-textbox" style="font-weight: bold; width: 100%;" maxlength="50" />
                            </div>
                            <div class="col col-md-2">
                                <div class="row rightAlign" style="float: right; margin-right: 1px; ">
                                    <span class="k-card-action"><span class="k-button k-flat k-primary" id="closeid" style="height: 30px; width: 80px" onclick="div4Close()">@ESCHOOL.Resources.Resource.Close</span></span>
                                </div>
                                <script>
                                    $(document).ready(function () {
                                        $("#closeid").kendoButton({
                                            icon: "close",
                                        });
                                    });
                                </script>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>

        <div id="vertical" style="height: 450px; border: thin solid rgb(120,120,120);padding-top: 0px; padding-left:0px;">
            <div id="top-pane" style="height: 100%; width: 100%;">
                <div id="horizontal" style="height: 100%; padding-left:0px;">
                    <div id="right-pane">
                        <div class="pane-content">
                            <h5 class="ra-well-title card-header top-left" style="padding-top:4px; padding-bottom:6px;">
                                <kbd>@ESCHOOL.Resources.Resource.Debt</kbd>
                            </h5>
                            <div id="Installments">
                                <div id="gridInstallments" style="height:200px;padding:2px;"></div>

                                <div class="col">
                                    <img src="@("~/Upload/Menu/Paid.png")" asp-append-version="true" class="img-fluid" />&nbsp;@ESCHOOL.Resources.Resource.Payed&nbsp;&nbsp;&nbsp;
                                    <img src="@("~/Upload/Menu/Partialpayment.png")" asp-append-version="true" />&nbsp;@ESCHOOL.Resources.Resource.PartialPayment
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="center-pane">
                        <div class="pane-content">
                            <h5 class="ra-well-title card-header top-left" style="padding-top:2px;">
                                <kbd>@ESCHOOL.Resources.Resource.Collection</kbd>
                            </h5>
                            <div class="gridIP" id="gridPayments" style="padding:2px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--#region scripts butoons, vertical, horizontal -->
        <script>
            $(function () {
                $("#collectionButtons1").kendoButtonGroup({
                    index: 3,
                });
                $("#collectionButtons2").kendoButtonGroup({
                    index: 0,
                });
            });
        </script>

        <script>
            $(document).ready(function () {
                $("#vertical").kendoSplitter({
                    orientation: "vertical",
                    panes: [
                        { collapsible: false },
                        { collapsible: false, size: "100px" },
                        { collapsible: false, resizable: false, size: "100px" }
                    ]
                });

                $("#horizontal").kendoSplitter({
                    panes: [
                        { collapsible: true, size: "610px" },
                        { collapsible: true },
                        { collapsible: true }
                    ]
                });
            });
        </script>
        <!--#endregion -->
        <!--#region style -->
        <style>

            #vertical {
                height: 390px;
                margin: 0 auto;
            }

            #middle-pane {
                color: #000;
                background-color: #ccc;
            }

            #bottom-pane {
                color: #000;
                background-color: #aaa;
            }

            #left-pane {
                color: #000;
                background-color: #eee;
                padding: 0 0;
            }

            .pane-content {
                padding: 1px 1px;
            }

            .k-grid td {
                white-space: nowrap;
                text-overflow: ellipsis;
            }

            #grid .k-grid-toolbar {
                padding: .6em 1.3em .6em .4em;
            }

            #gridFees .k-grid-content {
                height: 120px;
                max-height: 120px;
            }

            #gridStudents .k-grid-content {
                height: 210px;
                max-height: 215px;
            }

            /*GRID header WRAP*/
            .gridIP .k-grid-header .k-header .k-link {
                height: auto;
            }

            .gridIP .k-grid-header .k-header {
                white-space: normal;
            }

            .gridIP .k-grid-content {
                min-height: 200px;
                max-height: 600px;
            }

            .k-header {
                font-weight: bold !important;
                font-size: 12px;
            }

            .discontinued {
                font-weight: bold;
                color: #f00;
            }

            .critical {
                background-color: #fdd;
            }

            .warning {
                background-color: #fda;
            }

            .ok {
                background-color: #ced;
            }

            .critical2 {
                color: #fdd;
            }

            .warning2 {
                color: #fda;
            }

            .ok2 {
                color: #ced;
            }

            .k-upload-status {
                display: none;
            }

            .ui-datepicker.ui-datepicker-inline {
                width: 100% !important;
            }

            div.border {
                border-style: solid;
                border-color: coral;
            }

            #fieldlist {
                margin: 0 0 -2em;
                padding: 0;
            }

                #fieldlist li {
                    list-style: none;
                    padding-bottom: 0em;
                }


            hr.space-1 {
                background: transparent;
                color: transparent;
                margin: 0;
                border-style: none;
                height: 0.5vw;
            }

            form label {
                font-weight: bold;
                font-size: 12px;
            }

        </style>
        <!--#endregion -->
    </form>

    <!--#region dictionary -->
    <script>
        var dictionary =
        {
            'tr-TR': {
                select: 'Seç',
                selectbankName: 'Banka Seçimini Yapınız.',
                enterValidAmount: 'Geçerli Bir Tutar Giriniz.',
                selectclassroom: 'Öğrencinin Sınıfını Giriniz.',
                feetableempty: 'Ücret tablosu girilmemiş.',
                studentfeeempty: 'Öğrenci ücretleri girilmemiş.',
                aboutRefundMsg: 'Notlarınız Kaydedildi.',
                deleted: "Tahsil Kaydı Silindi.",
                delete: "Tahsil Kaydı Silinecek, Emin misiniz?",
                maxTotal: "Dikkat; Bakiye Tutarından Büyük Bir Tutar Giremezsiniz.",
                titleMsg: 'Kullanıcı Mesajı:',
                receiptNo: 'Makbuz No Okunamadı, Tekrar Deneyiniz...',
                msgOk: 'Tamam',
                total: "Toplam",
                itemsfound: "kayıt bulundu",
                studenttxt: " Bu Öğrencinin ",
                periodtxt: " Dönemine Ait Ödenmemiş ",
                txt: " TL. Borcu Vardır.",
                txtInfo: " Dönemler Seçeneğinden inceleyebilirsiniz.",
                paymentWarning1: "Girilen Ödeme Tutarı, Geçerli Bir Ödeme Tutarı Olmalıdır.",
                paymentWarning2: "Girilen Ödeme Tutarı",
                paymentWarning22: "Seçilen Toplam Taksit Miktarlarından Büyük Olamaz.",
            },

            'en-US': {
                select: 'Select',
                selectbankName: 'Select the bank name.',
                enterValidAmount: 'Enter Valid Amount.',
                selectclassroom: "Enter Student's Class.",
                feetableempty: 'The wage table has not been entered.',
                studentfeeempty: 'Enter student fees.',
                aboutRefundMsg: 'Your notes have been recorded.',
                deleted: "Student collections record deleted.",
                delete: "Are you sure, Collection record will be deleted?",
                maxTotal: "Attention; You cannot enter an amount greater than the balance amount.",
                titleMsg: 'User message:',
                receiptNo: 'Receipt No. Could Not Read, Try again...',
                msgOk: 'OK',
                total: "Total",
                itemsfound: "items found",
                studenttxt: " This Student's Unpaid ",
                periodtxt: " for the Period TL.",
                txt: " Has Debt",
                txtInfo: " You can review it from the periods Option.",
                paymentWarning1: "The Payment Amount Entered Must Be a Valid Payment Amount.",
                paymentWarning2: "The Payment Amount Entered",
                paymentWarning22: "Cannot Be Greater Than the Selected Total Installment Amounts.",
            },
        }
        function getByCulture(culture, word) {
            return dictionary[culture][word]
        }
    </script>
    <!--#endregion -->
    <!--#region students -->

    <script>
        function onChange(arg) {
            var grid = $("#gridStudents").data("kendoGrid");
            var selectedItem = grid.dataItem(grid.select());

            var filename = document.getElementById('imgpreviewStudent').value;
            filename = selectedItem.studentPicture;
            var ID = selectedItem.studentID

            document.getElementById("studentID").value = ID;
            document.getElementById("imgpreviewStudent").src = '@Url.Content("~/Upload/Students/")' + filename;
            document.getElementById("name").value = selectedItem.name;

            document.getElementById("statuCategory").value = selectedItem.statuCategory;
            document.getElementById("registrationTypeCategory").value = selectedItem.registrationTypeCategory;

            var date = kendo.toString(kendo.parseDate(selectedItem.dateOfRegistration), "dd/MM/yyyy");
            document.getElementById("dateOfRegistration").value = date;

            document.getElementById("total").value = selectedItem.total;
            document.getElementById("debt").value = selectedItem.totalDebt;

            document.getElementById('receiptNo').value = "";
            document.getElementById('receiptNoId').value = "";
            document.getElementById('installmentAmount1').value = "";
            document.getElementById('checkNo1').value = "";

            document.getElementById("cancel").disabled = true;
            document.getElementById("printer").disabled = true;

            document.getElementById("divideid").disabled = true;
            document.getElementById("changeid").disabled = true;

            document.getElementById("cancelid").disabled = true;
            document.getElementById("okButtonid").disabled = true;
            document.getElementById("printerid").disabled = true;

            if (ID > 0) {
                $.ajax({
                    type: "POST",
                    url: "/M300Collections/StudentPeriodsDataRead/" + "@Model.UserID" + "/" + ID,
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    success: function (result) {
                        var amount = 0;
                        for (var i = 0; i < result.length; i++) {
                            var studenttxt = getByCulture('@culture', 'studenttxt');
                            var periodtxt = getByCulture('@culture', 'periodtxt');
                            var msg1 = studenttxt + result[i].period + periodtxt;
                            var msg2 = getByCulture('@culture', 'txt');
                            var msg3 = getByCulture('@culture', 'txtInfo');
                            var sw = document.getElementById('switchId1').value;
                            if (result[i].period != "@Model.Period" && result[i].balance > 0 && sw == 0) {
                                showStaticNotification(msg1, msg2, msg3, result[i].period, result[i].balance);
                            }
                        }

                        var grid = $("#gridStudentPeriods").data("kendoGrid");
                        var dataSource = new kendo.data.DataSource({ data: result });
                        grid.setDataSource(dataSource);
                    },

                });
            }



            $.ajax({
                type: "POST",
                url: "/M300Collections/SchoolDebtDataRead/" + "@Model.UserID" + "/" + "@Model.Period" + "/" + ID,
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    var grid = $("#gridFees").data("kendoGrid");
                    var dataSource = new kendo.data.DataSource({ data: result });
                    grid.setDataSource(dataSource);
                },
            });

            $.ajax({
                type: "POST",
                url: '/M300Collections/InstallmentDataRead/' + "@Model.UserID" + "/" + "@Model.Period" + "/" + ID,
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    var grid = $("#gridInstallments").data("kendoGrid");
                    var dataSource = new kendo.data.DataSource({ data: result });
                    grid.setDataSource(dataSource);
                },
            });
            if (ID > 0) {
                $.ajax({
                    type: "POST",
                    url: "/M300Collections/StudentTempRead?studentID=" + ID + "&period=" + "@Model.Period" + "&schoolID=" + "@Model.SchoolID",
                    dataType: "json",
                    success: function (result) {
                        var combobox = $("#accountCode").data("kendoMultiColumnComboBox");
                        combobox.select(function (dataItem) {
                            return dataItem.name = result.accountCode;
                        });
                        document.getElementById("accountExplanation").value = result.accountExplanation;
                        document.getElementById('isFormPrint').checked = result.isFormPrint;
                    },
                });
            }

            var grid = $("#gridPayments").data("kendoGrid");
            grid.dataSource.options.transport.read.url = "/M300Collections/PaymentsDataRead/" + "@Model.UserID" + "/" + "@Model.Period" + "/" + ID;
            grid.dataSource.read();
            grid.refresh();

        };

        var isSelect = false;
        var isSibling = false;
        var record1 = 0;
        $(document).ready(function () {
            var crudServiceBaseUrl = "/M300Collections/",
                dataSource = new kendo.data.DataSource({
                    transport: {
                        read: {
                            url: crudServiceBaseUrl + "GridStudentDataRead/" + "@Model.UserID" + "/" + "false" + "/" + "false" + "/" + "false",
                            dataType: "json"
                        },

                        parameterMap: function (options, operation) {
                            if (operation !== "read" && options.models) {
                                return { models: kendo.stringify(options.models) };
                            }
                        }
                    },
                    batch: true,
                    schema: {
                        model: {
                            id: "viewModelId",
                            fields: {
                                viewModelId: { editable: false, type: "number" },
                                name: { editable: false, type: "string" },
                                statuCategory: { editable: false, type: "string" },
                                registrationTypeCategory: { editable: false, type: "string" },
                                dateOfRegistration: { editable: false, type: "date", format: "{0:yyyy-MM-dd HH:mm:ss}" },
                                studentPicture: { editable: false, type: "string" },
                                balance: { editable: true, type: "number" },
                            }
                        }
                    },
                });

            var first = 1;
            var grid = $("#gridStudents").kendoGrid({
                dataSource: dataSource,
                sortable: {
                    mode: "single",
                    allowUnsort: false
                },
                resizable: true,
                selectable: 'row',
                change: onChange,
                toolbar: [
                    { template: kendo.template($("#template").html()) }
                ],
                columns: [
                    {
                        template:
                            "<div class='customer-photo'" +
                            "style='background-image: url(../Upload/Students//#:studentPicture#); width: 28px;'></div>",
                    },
                    { field: "name", title: "@ESCHOOL.Resources.Resource.StudentName", footerTemplate: "#= sumStudent(1) #", width: "160px", },
                    { field: "studentClassroom", title: "@ESCHOOL.Resources.Resource.Classrooms", width: "65px" },
                    { field: "studentSerialNumber", title: "@ESCHOOL.Resources.Resource.CardRegisterNo", width: "65px" },
                    { field: "balance", title: "@ESCHOOL.Resources.Resource.BalanceAmount", template: "#if(balance === 0){#  #}else{# #=kendo.toString(balance, 'n')# #}#", footerTemplate: "<div style='text-align: right'>#: kendo.toString(sumStudent(2),'n') # </div>", attributes: { style: "text-align:right" }, width: "90px" },

                    { field: "@Model.CategoryName2" },
                    { field: "registrationTypeCategory" },
                    { field: "studentPicture" },
                ],
                dataBinding: function () {
                    record = (this.dataSource.page() - 1) * this.dataSource.pageSize();
                },
                dataBound: function (e) {
                    if (isSelect == false) {
                        var selectID = ('@TempData["studentID"]');
                        if (selectID == 0) {
                            grid.select("tr:eq(0)");
                        }
                        else {
                            //Select scroll
                            gridSelectById(selectID), isSelect = true
                            //Select scroll
                            var scrollContentOffset = this.element.find("tbody").offset().top;
                            var selectContentOffset = this.select().offset().top;
                            var distance = selectContentOffset - scrollContentOffset;

                            //animate our scroll
                            this.element.find(".k-grid-content").animate({
                                scrollTop: distance
                            }, 400);
                        };
                    }
                    showLoadingOff();
                },
            });

            var dropDown = grid.find("#paymentDropDown").kendoDropDownList({
                optionLabel: { "@Model.CategoryName2": getByCulture('@culture', 'select'), categoryID: "0" },
                dataTextField: "@Model.CategoryName2",
                dataValueField: "categoryID",
                dataSource: {
                    type: "json",
                    severFiltering: true,
                    transport: {
                        read: {
                            url: "/M300Collections/PaymentTypeCombo",
                            dataType: "json"

                        },
                    }
                },
                change: function () {
                    showLoadingOn();
                    var value = this.value();
                    if (value == 0 || value != first) {
                        $.ajax({
                            type: "POST",
                            url: '/M300Collections/GridStudentDataReadFilter/' + "@Model.UserID" + '/' + value,
                            dataType: "json",

                            success: function (result) {
                                var grid = $("#gridStudents").data("kendoGrid");
                                var dataSource = new kendo.data.DataSource({ data: result });
                                grid.setDataSource(dataSource);

                                var grid = $("#gridFees").data("kendoGrid");
                                var dataSource = new kendo.data.DataSource({ data: result });
                                grid.setDataSource(dataSource);

                                var grid = $("#gridInstallments").data("kendoGrid");
                                var dataSource = new kendo.data.DataSource({ data: result });
                                grid.setDataSource(dataSource);

                            },
                            error: function (httpRequest, textStatus, errorThrown) {
                                alert("Error: " + textStatus + " " + errorThrown + " " + httpRequest);
                            }
                        });
                        first = 0;
                    };
                },
            }).data("kendoDropDownList");

            var grid = $("#gridStudents").data("kendoGrid");
            grid.hideColumn(5);
            grid.hideColumn(6);
            grid.hideColumn(7);
            grid.hideColumn(8);
            grid.hideColumn(9);
        });

        function sumStudent(e) {
            var total = 0;
            var $grid = $('#gridStudents');
            var kendo = $grid.data().kendoGrid;
            var data = kendo.dataSource.data();
            var count = 0;
            var amount = 0;
            for (var i = 0; i < data.length; i++) {
                if (e == 1) count += 1;
                {
                    if (count == NaN) {
                        count = 0;
                    }
                    total = count;
                }

                if (e == 2) {
                    amount += parseFloat(data[i].balance)
                    if (amount == NaN) {
                        amount = 0;
                    }
                    total = amount;
                }

            }
            //total = amount;
            return total;
        }

        function gridSelectById(id) {
            var grid = $("#gridStudents").data().kendoGrid;
            var data = grid.dataSource.data();
            for (var i = 0; i < data.length; i++) {
                if (data[i].studentID == id) {
                    var select = grid.tbody.find('tr[data-uid="' + data[i].uid + '"]');
                    grid.select(select);
                }
            }
            var selectedRow = grid.select();
            var selectedDataItem = grid.dataItem(selectedRow);
        }
    </script>
    <script>
        function showLoadingOn() {
            var myGrid = $("#gridStudents").getKendoGrid();
            kendo.ui.progress($("#gridStudents"), true);
        }
        function showLoadingOff() {
            var myGrid = $("#gridStudents").getKendoGrid();
            kendo.ui.progress($("#gridStudents"), false);
        }
    </script>
    <script>
        function studentsRefresh() {
            displayLoading("#gridStudents");
            document.getElementById('switchId2').value = 0;
            var myWindow = $("#siblings").hide(500);

            var grid = $("#gridStudents").data("kendoGrid");
            grid.dataSource.options.transport.read.url = "/M300Collections/GridStudentDataRead/" + "@Model.UserID" + "/" + "false" + "/" + "false" + "/" + "false";
            grid.dataSource.read();
            grid.refresh();
            $("#gridSiblings").data("kendoGrid").clearSelection();
        }
        function displayLoading(target) {
            var element = $(target);
            kendo.ui.progress(element, true);
            setTimeout(function () {
                kendo.ui.progress(element, false);
            }, 2000);
        }
    </script>

    <!--#endregion -->
    <!--#region grid fees Top -->
    <script>
        $(document).ready(function () {
            var crudServiceBaseUrl = "/M300Collections/",
                dataSource = new kendo.data.DataSource({
                    transport: {
                        read: {
                            url: crudServiceBaseUrl + "StudentDebtDataRead/" + "@Model.UserID" + "/" + "@Model.StudentID",
                            dataType: "json",
                        },
                        parameterMap: function (options, operation) {
                            if (operation !== "read" && options.models) {
                                return { models: kendo.stringify(options.models) };
                            }
                        }
                    },

                    batch: true,
                    schema: {
                        model: {
                            id: "studentDebtID",
                            fields: {
                                viewModelId: { editable: false, type: "number" },
                                studentID: { editable: false, type: "number" },
                                schoolFeeID: { editable: false, type: "number" },
                                period: { editable: false, type: "string" },
                                feeName: { editable: false, type: "string" },
                                selectFee: { type: "boolean" },
                                selectDiscount: { type: "boolean" },
                                unitPrice: { editable: true, type: "number" },
                                discount: { editable: false, type: "number" },
                                amount: { editable: false, type: "number" },
                                isList: { editable: true, type: "boolean" }
                            }
                        }
                    },
                });

            $("#gridFees").kendoGrid({
                dataSource: dataSource,
                pageable: false,
                resizable: true,
                selectable: 'row',
                columns: [
                    { field: "feeName", title: "@ESCHOOL.Resources.Resource.FeeName", footerTemplate: "#= sumAmounts(1) #", width: "125px", },
                    { field: "unitPrice", title: "@ESCHOOL.Resources.Resource.Amount", template: "#if(unitPrice === 0){#  #}else{# #=kendo.toString(unitPrice, 'n')# #}#", footerTemplate: "<div style='text-align: right'>#: kendo.toString(sumAmounts(2),'n') # </div>", attributes: { style: "text-align:right" }, width: "80px" },
                    { field: "discount", title: "@ESCHOOL.Resources.Resource.Discount", template: "#if(discount === 0){#  #}else{# #=kendo.toString(discount, 'n')# #}#", footerTemplate: "<div style='text-align: right'>#: kendo.toString(sumAmounts(3),'n') # </div>", attributes: { style: "text-align:right" }, width: "70px" },
                    { field: "amount", title: "@ESCHOOL.Resources.Resource.RegistrationFee", template: "#if(unitPrice === 0){#  #}else{# #=kendo.toString(amount = unitPrice - discount, 'n')# #}#", footerTemplate: "<div style='text-align: right'>#: kendo.toString(sumAmounts(4),'n') # </div>", attributes: { style: "text-align:right" }, width: "80px" },
                    { field: "isList", width: "40px", title: "@ESCHOOL.Resources.Resource.List", template: "<input  #if (isList) { # checked='checked' # } # type='checkbox' disabled />", attributes: { style: "text-align:center" } },
                ],
            });
        });

        function sumAmounts(e) {
            var total = 0;
            var $grid = $('#gridFees');
            var kendo = $grid.data().kendoGrid;
            var data = kendo.dataSource.data();
            var amount = 0;
            for (var i = 0; i < data.length; i++) {
                if (e == 1) amount += 1;
                if (e == 2) amount += parseFloat(data[i].unitPrice);
                if (e == 3) amount += parseFloat(data[i].discount);
                if (e == 4) amount += parseFloat(data[i].amount);
                if (amount == NaN) {
                    amount = 0;
                }
            }
            total = amount;
            return total;
        }

    </script>
    <!--#endregion -->
    <!--#region installment -->

    <script>
        function onChangeInstallment(e) {
            var amount = 0;
            var payment = 0;
            var totalAmount = 0;
            var checkno = "";
            var insID = "";
            var status = "";
            var categoryName = "";
            var rows = e.sender.select();
            var accountReceiptNo = null;
            var date1 = null;
            var date2 = null;
            var installmentID = 0;
            rows.each(function (e) {
                var grid = $("#gridInstallments").data("kendoGrid");
                var dataItem = grid.dataItem(this);
                amount = parseFloat(dataItem.installmentAmount);
                status = dataItem.status.trim();
                date2 = dataItem.installmentDate;
                installmentID = dataItem.studentInstallmentID;
                payment = parseFloat(dataItem.previousPayment);
                if (payment > 0 && amount > 0) {
                    amount = amount - payment;
                    accountReceiptNo = dataItem.accountReceiptNo;
                    date11 = dataItem.paymentDate;
                }
                if (amount > 0) {
                    if (checkno != "") checkno = checkno + ",";
                    checkno = checkno + dataItem.installmentNo;
                    totalAmount += amount;

                    if (insID != "") insID = insID + ",";
                    insID = insID + installmentID;

                    if (categoryName != "") categoryName = categoryName + ",";
                    categoryName = categoryName + dataItem.category;
                }
            })

            var date22 = kendo.toString(kendo.parseDate(date2), "dd/MM/yyyy");
            document.getElementById("date2").value = date22;
            document.getElementById("date3").value = date22;

            document.getElementById('installmentID').value = installmentID;

            document.getElementById('installmentAmount1').value = totalAmount.toFixed(2);
            document.getElementById('selectedAmount').value = totalAmount.toFixed(2);
            console.log(totalAmount.toFixed(2));

            document.getElementById('checkNo1').value = checkno;
            document.getElementById('insID1').value = insID;

            document.getElementById('categoryName').value = categoryName;
            document.getElementById('receiptNo').value = accountReceiptNo;
            document.getElementById('receiptNoId').value = accountReceiptNo;

            if (totalAmount > 0)
                $("#okButtonid").data("kendoButton").enable(true);
            else
                document.getElementById("okButtonid").disabled = true;

            if (accountReceiptNo > 0) {
                $("#cancel").data("kendoButton").enable(true);
                $("#printer").data("kendoButton").enable(true);
            }
            else {
                document.getElementById("cancel").disabled = true;
                document.getElementById("printer").disabled = true;
            }

            if (status == "Tahsil" || status == "" || installmentID == 0) {
                document.getElementById("divideid").disabled = true;
                document.getElementById("changeid").disabled = true;
            }
            else {
                $("#divideid").data("kendoButton").enable(true);
                $("#changeid").data("kendoButton").enable(true);
            }

            var date1 = kendo.toString(kendo.parseDate(date11), "dd/MM/yyyy");
            var date2 = $("#transactiondate1").val();

            if (date1 != date2) {
                document.getElementById("cancel").disabled = true;
            }
        }

        var record = 0;
        $(document).ready(function () {
            $("#gridInstallments").kendoGrid({
                dataSource: {
                    transport: {
                        read: {
                            url: "/M300Collections/InstallmentDataRead/" + "@Model.UserID" + "/" + "@Model.Period" + "/" + "@Model.StudentID",
                            dataType: "json",
                        }
                    },
                    parameterMap: function (options, operation) {
                        if (operation !== "read" && options.models) {
                            data.studentID = ID;
                            return { models: kendo.stringify(options.models) };
                        }
                    },

                    schema: {
                        model: {
                            id: "studentInstallmentID",
                            fields: {
                                studentInstallmentID: { editable: false, type: "number" },
                                schoolID: { editable: false, type: "number" },
                                studentID: { editable: false, type: "number" },
                                installmentDate: { editable: false, type: "date" },
                                installmentNo: { editable: false, type: "number" },
                                feeName: { editable: false, type: "string" },
                                category: { editable: false, type: "string" },
                                installmentAmount: { editable: false, type: "number", format: "{0:#,##}" },
                                previousPayment: { editable: false, type: "number" },
                                status: { editable: false, type: "string" },
                                bank: { editable: false, type: "string" },
                                explanation: { editable: false, type: "string" },
                                accountReceiptNo: { editable: false, type: "string" },
                                paymentDate: { editable: false, type: "date" },
                            }
                        }
                    },
                },
                //pageable: false,
                resizable: true,
                height: 'auto',
                /*height: 325,*/
                /*scrollable: false, önemli select edilen toplamları tek sayıyor, aksi durumuda çift sayıyor*/
                scrollable: false,
                persistSelection: true,
                //height: 260,
                change: onChangeInstallment,
                columns: [
                    /*"id",*/
                    {
                        title: "#", template: "#= ++record #", width: 40, locked: true, footerTemplate: "#= sumInstallment(1) #",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },
                    {
                        selectable: true, width: "50px", title: getByCulture('@culture', 'select'), name: "selectable1", id: "selectable1",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },
                    {
                        field: "installmentDate", title: "@ESCHOOL.Resources.Resource.Date", width: "100px", format: "{0:dd.MM.yyyy}", template: '#= kendo.toString(kendo.parseDate(installmentDate), "dd/MM/yyyy")#',
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },

                    {
                        field: "feeName", title: "@ESCHOOL.Resources.Resource.FeeName", width: "60px", template: "#=feeName#",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },
                    {
                        field: "installmentNo", title: "@ESCHOOL.Resources.Resource.Number", width: "60px", template: "#=installmentNo#",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },
                    {
                        field: "category", title: "@ESCHOOL.Resources.Resource.Type", width: "70px", template: "#=category#",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },
                    {
                        field: "installmentAmount", title: "@ESCHOOL.Resources.Resource.Amount", footerTemplate: "<div style='text-align: right'>#: kendo.toString(sumInstallment(2),'n') # </div>", width: "90px", template: "#if(installmentAmount === 0){#  #}else{# #=kendo.toString(installmentAmount, 'n')# #}#", format: "{0:#,##}",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#", style: "text-align:right" }
                    },
                    {
                        field: "balance", title: "@ESCHOOL.Resources.Resource.BalanceAmount", width: "90px", template: "#if(balance === 0){#  #}else{# #=kendo.toString(balance, 'n')# #}#", format: "{0:#,##}",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#", style: "text-align:right" }
                    },
                    {
                        field: "status", title: "@ESCHOOL.Resources.Resource.Status", width: "80px", template: "#=status#",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },

                    {
                        field: "bank", title: "@ESCHOOL.Resources.Resource.Bank", width: "150px", template: "#=bank#",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },
                    {
                        field: "explanation", title: "@ESCHOOL.Resources.Resource.Explanation", width: "200px", template: "#if(explanation === null){#  #}else{# #=explanation#  #}#",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },
                    {
                        field: "accountReceiptNo", title: "@ESCHOOL.Resources.Resource.AccountingReceipt", width: "80px", template: "#if(accountReceiptNo === 0){#  #}else{# #=accountReceiptNo#  #}#",
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },
                    {
                        field: "paymentDate", title: "@ESCHOOL.Resources.Resource.Date", width: "100px", format: "{0:dd.MM.yyyy}", template: '#= kendo.toString(kendo.parseDate(paymentDate), "dd/MM/yyyy")#',
                        attributes: { 'class': "#=setColor(installmentAmount, previousPayment)#" }
                    },
                    { field: "studentInstallmentID" },
                ],

                dataBinding: function (e) {
                    record = 0;
                    if (e.items[0].feeName != "") grid.showColumn(3)
                    else grid.hideColumn(3);
                },
            });
            var grid = $("#gridInstallments").data("kendoGrid");

            grid.hideColumn(12);
            grid.hideColumn(13);
        });

        function getColorClass(amount, payment) {
            if (amount == payment) {
                return "critical";
            }
            else if (payment > 0) {
                return "ok";
            }
        }
        function getColorClass2(amount, payment) {
            if (amount == payment) {
                return "critical2";
            }
            else if (payment > 0) {
                return "ok2";
            }
        }


        function sumInstallment(e) {
            var total = 0;
            var $grid = $('#gridInstallments');
            var kendo = $grid.data().kendoGrid;
            var data = kendo.dataSource.data();
            var amount = 0;
            for (var i = 0; i < data.length; i++) {
                if (e == 1) amount += 1;
                if (e == 2) amount += parseFloat(data[i].installmentAmount);
                if (amount == NaN) {
                    amount = 0;
                }
            }
            total = amount;
            return total;
        }

        function setColor(amount, payment) {
            if ('@TempData["color"]' != "#222") {
                if (amount == payment) {
                    return "critical";
                }
                else if (payment > 0) {
                    return "ok";
                }
            }
            else {
                if (amount.toFixed(2) == payment) {
                    return "critical2";
                }
                else if (payment > 0) {
                    return "ok2";
                }
            }
        }
    </script>



    <!--#endregion -->
    <!--#region payments -->
    <script>
        var record = 0;
        var studentID = document.getElementById("studentID").value;
        $(document).ready(function () {
            var crudServiceBaseUrl = "/M300Collections/",
                dataSource = new kendo.data.DataSource({
                    transport: {
                        read: {
                            url: crudServiceBaseUrl + "PaymentsDataRead/" + "@Model.UserID" + "/" + "@Model.Period" + "/" + studentID,
                            dataType: "json",
                        },
                        create: {
                            url: function (options) {
                                var url = crudServiceBaseUrl + "PaymentsDataCreate/" + options.models[0].id + "/" + "@Model.UserID";
                                return url;
                            },
                            type: "post",
                            dataType: "json"
                        },

                        parameterMap: function (options, operation) {
                            if (operation !== "read" && options.models) {
                                return { models: kendo.stringify(options.models) };
                            }
                        }
                    },
                    pageSize: 20,
                    batch: true,
                    schema: {
                        model: {
                            id: "studentPaymentID",
                            fields: {
                                studentPaymentID: { editable: false, type: "number" },
                                studentID: { editable: false, type: "number" },
                                schoolID: { editable: false, type: "number" },
                                period: { editable: false, type: "string" },
                                explanation: { editable: false, type: "string" },
                                paymentDate: { editable: false, type: "date", format: "{0:yyyy-MM-dd HH:mm:ss}" },
                                receiptNo: { type: "number" },
                                paymentAmount: { editable: false, type: "number", format: '{0:#,##}' },
                                balanceAmount: { editable: false, type: "number", format: '{0:#,##}' },
                                accountReceipt: { type: "number" },
                                installmentNumbers: { type: "string" },
                                installmentIdentities: { type: "string" },
                            },
                        }
                    },
                });

            $("#gridPayments").kendoGrid({
                dataSource: dataSource,
                /* navigatable: true,*/
                pageable: false,
                resizable: true,
                selectable: 'row',
                /*persistSelection: true,*/
                height: 345,
                columns: [
                    "id",
                    { title: "#", template: "#= ++record #", width: 30, locked: true, footerTemplate: "#= sumPayments(1) #", },
                    { field: "explanation", title: "@ESCHOOL.Resources.Resource.Explanation", width: "50px", template: "#= (explanation == null) ? ' ' : explanation #" },
                    { field: "paymentDate", type: 'date', title: "@ESCHOOL.Resources.Resource.Date", width: "85px", format: "{0:dd/MM/yyyy}", template: '#= kendo.toString(paymentDate, "dd/MM/yyyy") #' },
                    { field: "receiptNo", title: "@ESCHOOL.Resources.Resource.ReceiptNo", width: "60px", template: "#=receiptNo#" },
                    { field: "accountReceipt", title: "@ESCHOOL.Resources.Resource.AccountReceiptNo", width: "60px", template: "#=accountReceipt#" },
                    { field: "paymentAmount", title: "@ESCHOOL.Resources.Resource.Amount", template: "#if(paymentAmount === 0){#  #}else{# #=kendo.toString(paymentAmount, 'n')# #}#", footerTemplate: "<div style='text-align: right'>#: kendo.toString(sumPayments(2),'n') # </div>", width: "80px", attributes: { style: "text-align:right" } },
                    { field: "balanceAmount", title: "@ESCHOOL.Resources.Resource.BalanceAmount", template: "#if(balanceAmount === 0){#  #}else{# #=kendo.toString(balanceAmount, 'n')# #}#", footerTemplate: "<div style='background-color:black; color:white; text-align: right;'>#: kendo.toString(sumPayments(3),'n') # </div>", width: "85px", attributes: { style: "text-align:right" } },
                ],
                dataBinding: function () {
                    record = (this.dataSource.page() - 1) * this.dataSource.pageSize();
                },
            });
        });

        function paymentSave() {
            showPopupNotification();
            secondFunction()
        }

        //1. Task
        function firstFunction() {
            var grid = $("#gridPayments").data("kendoGrid");
            grid.saveChanges();
            studentTempUpdate();
        }
        //2. Task
        async function secondFunction() {
            await firstFunction()

            setTimeout(function () {
                var isFormPrint = document.getElementById('isFormPrint').checked;
                var studentID = document.getElementById("studentID").value;
                if (isFormPrint) {
                    var receiptNo = document.getElementById("receiptId").value;
                    if (receiptNo == "") receiptNo = null;
                    url = "/ListPanel/List1000?userID=" + @Model.UserID + "&studentID=" + studentID + "&msg=9" + "&exitID=2" + "&receiptNo=" + receiptNo + "&paymentSW=1" + "&formTypeSW=2";
                    window.location.replace(url);
                }
                else {
                    url = "/M300Collections/Collections?userID=" + "@Model.UserID" + "&studentID=" + studentID + "&isMenu=3";
                    window.location.replace(url);
                }
            }, 3000);
        };

        function studentTempUpdate() {
            var studentID = document.getElementById("studentID").value;
            var accountCode = document.getElementById("accountCode").value;
            var accountExplanation = document.getElementById("accountExplanation").value;

            var isFormPrint = document.getElementById('isFormPrint').checked;
            $.ajax({
                type: "POST",
                url: "/M300Collections/StudentTempUpdate?schoolID=" + "@Model.SchoolID" + "&studentID=" + studentID + "&period=" + "@Model.Period" + "&accountCode=" + accountCode + "&accountExplanation=" + accountExplanation + "&isFormPrint=" + isFormPrint,
                dataType: "json",
            });
        }

        function paymentPrinter() {
            var studentID = document.getElementById("studentID").value;
            var receiptNo = document.getElementById("receiptNo").value;
            $.ajax({
                type: "POST",
                url: "/M300Collections/ReceiptNoUpdate?schoolID=" + "@Model.SchoolID" + "&studentID=" + studentID + "&period=" + "@Model.Period" + "&receiptNo=" + receiptNo,
                dataType: "json",
            });

            url = "/ListPanel/List1000?userID=" + @Model.UserID + "&studentID=" + studentID + "&msg=8" + "&exitID=2" + "&receiptNo=' '" + "&paymentSW=1" + "&formTypeSW=2";
            window.location.replace(url);
        }

        function sumPayments(e) {
            var total = 0;
            var $grid = $('#gridPayments');
            var kendo = $grid.data().kendoGrid;
            var data = kendo.dataSource.data();
            var amount = 0;
            var balance = 0;
            for (var i = 0; i < data.length; i++) {
                if (e == 1) amount += 1;
                if (e == 2) amount += parseFloat(data[i].paymentAmount);
                if (e == 3) amount = parseFloat(data[i].balanceAmount);
                if (amount == NaN) {
                    amount = 0;
                }
            }
            total = amount;
            return total;
        }

        function paymentAddControl() {
            var selectedAmount = parseFloat(document.getElementById('selectedAmount').value);
            var selectedPayment = parseFloat(document.getElementById('installmentAmount1').value);
            var msg = "";
            if (selectedPayment == 0 || selectedPayment > selectedAmount) {
                if (selectedPayment == 0) var msg = getByCulture('@culture', 'paymentWarning1');
                if (selectedPayment > selectedAmount) 
                {
                    var msg = getByCulture('@culture', 'paymentWarning2') + " ( " + selectedPayment + " ), " + "\n" + getByCulture('@culture', 'paymentWarning22') + " ( " + selectedAmount + " )";
                }
                alert(msg);
            }
            else paymentAdd();
        }

        function paymentAdd() {
            var grid = $("#gridPayments").data("kendoGrid");
            var paymentDate = $("#transactiondate1").data("kendoDatePicker").value();
            var schoolID = "@Model.SchoolID";
            var studentID = document.getElementById('studentID').value;
            var categoryName = document.getElementById('categoryName').value;
            var studentPaymentID = studentID;
            var period = "@Model.Period";
            var explanation = "";

            var paymentAmount = document.getElementById('installmentAmount1').value;
            var debt = document.getElementById("debt").value;
            var balanceAmount = debt - paymentAmount;



            var accountReceipt = 0;
            var installmentNumbers = document.getElementById('checkNo1').value;
            var installmentIdentities = document.getElementById('insID1').value;

            // ekrandaki tarihin bir gün gerisinden gitmesini önlemek için alttaki iki satır eklendi
            x = (paymentDate);
            x.setHours(x.getHours() - x.getTimezoneOffset() / 60);
            /////////////////////////////////////////////

            var receiptNo = 0;
            $.ajax({
                type: "POST",
                url: '/M300Collections/ReceiptNoRead/' + "@Model.UserID" + "/" + schoolID + "/" + categoryName,
                dataType: "json",
                success: function (result) {
                    if (result.receiptNo == 0) {
                        msg = getByCulture('@culture', 'receiptNo');
                        alert(msg)
                    }
                    else {
                        receiptNo = result.receiptNo;
                        checkOrFromHand = result.checkOrFromHand;
                        if (checkOrFromHand) {
                            $("#div4").show(500);
                        }
                        document.getElementById('receiptNo').value = receiptNo;
                    }
                },
            }).done(function () {
                receiptNo = document.getElementById('receiptNo').value;
                grid.dataSource.add({ studentPaymentID: 0, studentID: studentID, schoolID: schoolID, period: period, explanation: explanation, paymentDate: paymentDate, receiptNo: receiptNo, paymentAmount: paymentAmount, balanceAmount: balanceAmount, accountReceipt: accountReceipt, installmentNumbers: installmentNumbers, installmentIdentities: installmentIdentities });

            });

            $("#cancelid").data("kendoButton").enable(true);
            $("#okButtonid").data("kendoButton").enable(false);
            $("#printerid").data("kendoButton").enable(true);

            $("#gridInstallments").data("kendoGrid").hideColumn(1);
        }

        $("#cancel").on("click", function () {
            if ("@Model.IsPermissionCancel" == 'False') {
                permissionsControlCancel();
            }
            else {
                msg = getByCulture('@culture', 'delete');
                kendo.confirm(msg)
                    .then(function () {
                        $('body').addClass('waiting');
                        $('html,body').css('cursor', 'wait');
                        $('cancel').addClass('disabled');
                        cancelPayment1();
                        $('body').removeClass('waiting');
                        $('html,body').css('cursor', 'default');
                    }, function () {
                        //kendo.alert("You chose to Cancel action.");
                    });
            }
        });
        function cancelPayment2() {
            $('#gridPayments').data('kendoGrid').dataSource.cancelChanges();
            document.getElementById("okButtonid").disabled = true;
            document.getElementById("printerid").disabled = true;
            $("#okButtonid").data("kendoButton").enable(true);

            $("#gridInstallments").data("kendoGrid").showColumn(1);
            div4Close();
        }

        function cancelPayment1() {
            var accountReceiptNo = document.getElementById('receiptNo').value;
            var studentID = document.getElementById("studentID").value
            $.ajax({
                url: '/M300Collections/PaymentDelete/' + "@Model.UserID" + "/" + studentID + "/" + accountReceiptNo,
                type: "post",
                dataType: "json",
                success: function (result) {
                    var selectID = ('@TempData["studentID"]');
                    window.location.replace("/M300Collections/Collections?userID=@Model.UserID&studentID=@TempData["studentID"]&isMenu=3");
                    showPopupNotification()
                },
            });
        }
    </script>

    <!--#region multicombobox  -->
    <script>
        $(document).ready(function () {
            $(".Accounting").kendoMultiColumnComboBox({
                dataTextField: "accountCode",
                dataValueField: "accountCode",
                height: 400,
                columns: [
                    { field: "accountCode", title: getByCulture('@culture', 'accountingCode'), width: 200 },
                    { field: "accountCodeName", title: getByCulture('@culture', 'accountingCodeName'), width: 400 },
                ],

                footerTemplate: getByCulture('@culture', 'total') + ' #: instance.dataSource.total() # ' + getByCulture('@culture', 'itemsfound'),
                filter: "contains",
                filterFields: ["accountCode", "accountCodeName"],
                dataSource: {
                    dataType: "json",
                    transport: {
                        read: {
                            dataType: "json",
                            url: "/M300Collections/AccountCodesRead/" + "@Model.Period",
                        }
                    }
                }
            });
        });
    </script>
    <!--#endregion -->


    <script language="JavaScript">
        function calculator() {
            WshShell = new ActiveXObject("WScript.Shell");
            WshShell.Run("C:/windows/system32/calc.exe", 1, false);
        }
    </script>

    <!--#endregion -->

    <script>
        var ID, btn, odd = 0, even = 0, result, i, j, z, tcTotal = 0;
        function myFunction(e) {
            btn = e.id;
            if (btn == "btn1") { IDT = "#id1", ID1 = "id1" }
            else
                if (btn == "btn2") { IDT = "#id2", ID1 = "id2" }
                else
                    if (btn == "btn3") { IDT = "#id3", ID1 = "id3" }
                    else
                        if (btn == "btn4") { IDT = "#id4", ID1 = "id4" }
                        else { IDT = "#id5", ID1 = "id5" }

            ID = document.querySelector(IDT);

            odd = 0, even = 0, tcTotal = 0
            for (i = 0; i < 9; i += 2) {
                odd += Number(ID.value[i]);
            }
            odd *= 7;
            for (j = 1; j < 8; j += 2) {
                even += Number(ID.value[j]);
            }
            result = Math.abs(odd - even);
            for (z = 0; z < 10; z++) {
                tcTotal += Number(ID.value[z]);
            }
            if (ID.value.length !== 11) {
                idFalse()
            }
            else
                if (result % 10 != Number(ID.value[9])) {
                    idFalse()
                } else if (tcTotal % 10 != Number(ID.value[10])) {
                    idFalse()
                } else {
                    idTrue()
                }
        };

        function idFalse() {
            document.getElementById(ID1).style.color = "white";
            document.getElementById(ID1).style.backgroundColor = "red";
        };
        function idTrue() {
            document.getElementById(ID1).style.color = "white";
            document.getElementById(ID1).style.backgroundColor = "green";
        };

        function IdChange(e) {
            document.getElementById(e.id).innerHTML = '<i class = "fa fa-spinner fa-spin"></i>@ESCHOOL.Resources.Resource.IdControl';
        };
        function IdChangeOld(e) {
            document.getElementById(e.id).innerHTML = '<i class = "fa fa-bell"></i>@ESCHOOL.Resources.Resource.IdNumber';
        };

        function IdReset(e) {
            btn = e.id;
            if (btn == "btn1") ID1 = "id1"
            else if (btn == "btn2") ID1 = "id2"
            else if (btn == "btn3") ID1 = "id3"
            else if (btn == "btn4") ID1 = "id4"
            else if (btn == "btn5") ID1 = "id5"
            document.getElementById(ID1).style.color = "black";
            document.getElementById(ID1).style.backgroundColor = "white";
        };
    </script>

    <script>
        $(document).ready(function () {
            $('body').kendoTooltip({
                filter: '[title]:not([title=""])',
                autoHide: true,
                position: "top",
                animation: {
                    open: {
                        effects: "zoom",
                        duration: 150
                    }
                }
            });
        });
    </script>
    <!--#endregion -->
    <!--#region toolbar -->
    <style>
        #logoId img {
            width: 60px;
        }
    </style>
    <script>
        $(document).ready(function () {
            $("#toolbarMenu").kendoToolBar({
                items: [
                    {
                        template: "<img src='../Upload/Images/Logo.png' class='user-image' style='width:60px;'/>",
                        overflow: "never",
                    },
                    { template: "<h4 style='padding-left:20px;'>@ESCHOOL.Resources.Resource.StudentCardCollectionTransactions</h4>" },
                    { type: "spacer" },

                    { type: "button", id: "collectionList1", text: "@ESCHOOL.Resources.Resource.DebtList", icon: "page-footer-section" },
                    { type: "separator" },
                    { type: "button", id: "collectionList2", text: "@ESCHOOL.Resources.Resource.DebtListSiblingGroup", icon: "file-ascx" },
                    { type: "separator" },

                    { type: "button", id: "card", text: "@ESCHOOL.Resources.Resource.StudentCard", icon: "user" },
                    { type: "separator" },

                    { type: "button", id: "invoice", text: "@ESCHOOL.Resources.Resource.Invoice", icon: "file-data" },
                    { type: "separator" },

                    { type: "button", id: "help", text: "@ESCHOOL.Resources.Resource.Help", icon: "help" },
                    { type: "separator" },

                    { type: "button", id: "back", text: "@ESCHOOL.Resources.Resource.Back", attributes: { style: "float: right" }, icon: "rewind" },
                    { type: "separator" },

                    { type: "button", id: "exit", text: "@ESCHOOL.Resources.Resource.Exit", attributes: { style: "float: right; margin-top: .4em;" }, icon: "logout" },
                    { type: "separator" },
                ],

                click: function (e) {
                    if (e.id == "collectionList1") {
                        waitProgress();
                        var studentID = document.getElementById("studentID").value;
                        //var studentName = document.getElementById('name').value;
                        var studentName = "";
                        window.location.replace("/ListPanel/List109?userID=@Model.UserID&msg=0");
                    }
                    if (e.id == "collectionList2") {
                        waitProgress();
                        var studentID = document.getElementById("studentID").value;
                        //var studentName = document.getElementById('name').value;
                        var studentName = "";
                        window.location.replace("/ListPanel/List115?userID=@Model.UserID&msg=0");
                    }

                    if (e.id == "card") {
                        waitProgress();
                        var studentID = document.getElementById("studentID").value;
                        //var studentName = document.getElementById('name').value;
                        var studentName = "";
                        window.location.replace("/ListPanel/List204?userID=@Model.UserID" + "&studentID=" + studentID + "&studentName=" + studentName + "&exitID=8");
                    }
                    if (e.id == "invoice") {
                        var studentID = document.getElementById("studentID").value;
                        window.location.replace("/M400Invoice/InvoicePlan?userID=@Model.UserID&studentID=" + studentID);
                    }

                    if (e.id == "exit" || e.id == "back") {
                        if (studentID > 0)
                            $.ajax({
                                url: '/M300Collections/TempDataDelete/' + "@Model.StudentID",
                                type: "post",
                                dataType: "json"
                            });
                        if (e.id == "exit")
                            window.location.replace("/Home/index?userID=@Model.UserID");
                        else
                            window.location.replace("/M210Student/AddOrEditStudent?studentID=" + @Model.StudentID + "&userID=@Model.UserID");
                    }

                    if (e.id == "help") {
                        var myWindow = $("#panelbarHelp").show();
                        var panelBar = $("#panelbarHelp").data("kendoPanelBar");
                        panelBar.select(panelBar.element.children("li").eq(0));
                        panelBar._selected[0].style.display = 'block';
                        var item = panelBar.select();
                        panelBar.expand(item);
                    }
                }
            });
            if ("@Model.IsMenu" == 0) $("#back").hide();
            if ("@Model.IsPermission" == 'False' || "@Model.IsPermissionFee" == 'False') permissionsControl();
        });
    </script>
    <!--#endregion -->
</body>
</html>
<div id="alert"></div>
<script>
    function permissionsControl() {
        msg = getByCulture('@culture', 'msgOk');
        showAlert(msg);
    };

    function showAlert(message) {
        msg = getByCulture('@culture', 'titleMsg');
        $("#alert").kendoAlert({
            title: msg,
            content: "<strong>@ESCHOOL.Resources.Resource.PermissionMsg</strong>",
            messages: {
                okText: message
            },
            actions: [{
                text: "#: messages.okText #",
                action: function (e) {
                    window.location.replace("/Home/index?userID=@Model.UserID");
                }
            }]
        }).data("kendoAlert").open();
    };
</script>
<script>
    function permissionsControlCancel() {
        msg = getByCulture('@culture', 'msgOk');
        showAlertCancel(msg);
    };

    function showAlertCancel(message) {
        msg = getByCulture('@culture', 'titleMsg');
        $("#alert").kendoAlert({
            title: msg,
            content: "<strong>@ESCHOOL.Resources.Resource.PermissionMsg</strong>",
            messages: {
                okText: message
            },
            actions: [{
                text: "#: messages.okText #",
                action: function (e) {
                }
            }]
        }).data("kendoAlert").open();
    };
</script>
<!--#region grid fee and discount selections -->

<script>
    $(document).ready(function () {
        // create TextBox from input HTML element
        $("#textbox").kendoTextBox({
            placeholder: "Name..."
        });
    });
</script>

<script>
    $("#transactiondate1").kendoDatePicker({
        format: "dd/MM/yyyy"
    });
    var datepicker = $("#transactiondate1").data("kendoDatePicker");
    datepicker.value(new Date());

    $("#date1").kendoDatePicker({
        format: "dd/MM/yyyy"
    });
    var datepicker = $("#date1").data("kendoDatePicker");
    datepicker.value(new Date());

    $("#date2").kendoDatePicker({
        format: "dd/MM/yyyy"
    });
    var datepicker = $("#date2").data("kendoDatePicker");
    datepicker.value(new Date());

    $("#date3").kendoDatePicker({
        format: "dd/MM/yyyy"
    });
    var datepicker = $("#date3").data("kendoDatePicker");
    datepicker.value(new Date());
</script>


<!--#endregion -->
<!--#region upload -->
<script>
    var previewingStudent = function (event) {
        var result = document.getElementById("imgpreviewStudent")
        result.src = URL.createObjectURL(event.target.files[0]);
    };

    $(document).ready(function () {
        $("#imgfileStudent").kendoUpload({
            async: {
                //saveUrl: "save",
                removeUrl: "remove",
                autoUpload: true
            },
            localization: {
                select: '<i class="fa fa-upload"></i>'
            },
            showFileList: false
        });
    });

</script>

<script>
    $(document).ready(function () {
        $('#M300Collections').submit(function () {
            $('#M300Collections').find("[required=\"required\"]").attr("required", false);
            $(".needValidation").attr("required", true);
        });

        var validator = $("#M300Collections").kendoValidator().data("kendoValidator"),
            status = $(".status");
    });
</script>
<!--#endregion -->
<!--#region style -->
<style type="text/css">
    .customer-photo {
        display: inline-block;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background-size: 28px 31px;
        background-position: center center;
        vertical-align: middle;
        line-height: 28px;
        box-shadow: inset 0 0 1px #999, inset 0 0 10px rgba(0,0,0,.2);
        margin-left: 0px;
    }

    .toolbar {
        float: right;
    }

    #center {
        /*        display: block;*/
        margin-left: 22px;
        /*        margin-right: auto;*/
        /*        border: 8px ridge blue;*/
    }
</style>
<!--#endregion -->
<!--#region Add/Update -->
<script>
    $(document).ready(function () {
        $("#feeDropDown").kendoDropDownList({
            optionLabel: { @Model.CategoryName1: getByCulture('@culture', 'select'), bankID: "0" },
        dataTextField: "@Model.CategoryName1",
        dataValueField: "schoolFeeID",
        index: 1,
        dataSource: {
        transport: {
            read: {
                dataType: "json",
                url: "/M300Collections/FeeTypeCombo/" + "@Model.UserID",
            }
        }
    },
                });

    $(".paymentDropDown").kendoDropDownList({
        dataTextField: "@Model.CategoryName2",
        dataValueField: "categoryID",
        value: "@Model.SchoolInfo.DefaultPaymentTypeCategoryID",
        dataSource: {
            transport: {
                read: {
                    dataType: "json",
                    url: "/M300Collections/PaymentTypeCombo"
                }
            }
        }
    });

    $(".bankNameDropDown").kendoDropDownList({
        optionLabel: { bankName: getByCulture('@culture', 'select'), bankID: "0" },
        value: "@Model.SchoolInfo.DefaultBankID",
        dataTextField: "bankName",
        dataValueField: "bankID",
        dataSource: {
            transport: {
                read: {
                    dataType: "json",
                    url: "/M300Collections/BankNameCombo?userID=" + "@Model.UserID",
                }
            }
        },
    });

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       });

</script>
<script>
    function newShow1() {
        $("#div1").show(500);
        $("#div2").hide(500);
        $("#div3").hide(500);
    };
    function newShow2() {
        $("#div2").show(500);
        $("#div1").hide(500);
        $("#div3").hide(500);
    };
    function newShow3() {
        $("#div3").show(500);
        $("#div1").hide(500);
        $("#div2").hide(500);
    };
    function newShow4() {
        $("#div1").hide(500);
        $("#div2").hide(500);
        $("#div3").hide(500);
    };
    function div4Close() {
        $("#div4").hide(500);
    };
</script>

<script>
    function div1Button() {
        var feeNameID = document.getElementById('feeDropDown').value;
        var amount = document.getElementById('amount1').value;

        var date = $("#date1").data("kendoDatePicker").value();
        var dateString = kendo.toString(date, "dd-MM-yyyy");
        var studentID = document.getElementById("studentID").value;

        var paymentNameID = document.getElementById('paymentDropDown1').value;

        var paymentType = $("#paymentDropDown1").data("kendoDropDownList");
        var typeText = paymentType.text();
        var bankNameID = document.getElementById('bankNameDropDown1').value;

        if ((bankNameID == null || bankNameID == 0) && typeText != "Elden") {
            msg = getByCulture('@culture', 'selectbankName');
            alert(msg);
            return;
        }
        else {
            $.ajax({
                url: '/M300Collections/Div1Update/' + "@Model.UserID" + "/" + studentID + "/" + feeNameID + "/" + amount + "/" + dateString + "/" + paymentNameID + "/" + bankNameID,
                type: "post",
                dataType: "json",
                success: function (result) {
                    var selectID = ('@TempData["studentID"]');
                    window.location.replace("/M300Collections/Collections?userID=@Model.UserID&studentID=@Model.StudentID&isMenu=3");
                    showPopupNotification();
                },
            });
        }
    }
</script>

<script>
    function div2Button() {
        var date = $("#date2").data("kendoDatePicker").value();
        var dateString = kendo.toString(date, "dd-MM-yyyy");
        var paymentNameID = document.getElementById('paymentDropDown2').value;
        var bankNameID = document.getElementById('bankNameDropDown2').value;
        var studentID = document.getElementById("studentID").value;
        var installmentID = document.getElementById('installmentID').value;

        var maxTotal = document.getElementById("maxTotal").value;
        var amount = document.getElementById('amount2').value;
        var isSingle = document.getElementById('singlePayment').checked;
        if (isSingle == true && amount > maxTotal) {
            msg = getByCulture('@culture', 'maxTotal');
            alert(msg);
        }
        else {
            $.ajax({
                url: '/M300Collections/Div2Update/' + "@Model.UserID" + "/" + studentID + "/" + amount + "/" + dateString + "/" + paymentNameID + "/" + bankNameID + "/" + installmentID + "/" + isSingle,
                type: "post",
                dataType: "json",
                success: function (result) {
                    var selectID = ('@TempData["studentID"]');
                    window.location.replace("/M300Collections/Collections?userID=@Model.UserID&studentID=" + studentID + "&isMenu=3");
                    showPopupNotification();
                },
            });
        }
    }
</script>

<script>
    function div3Button() {
        var date = $("#date3").data("kendoDatePicker").value();
        var dateString = kendo.toString(date, "dd-MM-yyyy");
        var paymentNameID = document.getElementById('paymentDropDown3').value;
        var bankNameID = document.getElementById('bankNameDropDown3').value;
        var studentID = document.getElementById("studentID").value;
        var installmentID = document.getElementById('installmentID').value;
        var isNewNumber = document.getElementById('newNumber').checked;
        $.ajax({
            url: '/M300Collections/Div3Update/' + "@Model.UserID" + "/" + studentID + "/" + dateString + "/" + paymentNameID + "/" + bankNameID + "/" + installmentID + "/" + isNewNumber,
            type: "post",
            dataType: "json",
            success: function (result) {
                window.location.replace("/M300Collections/Collections?userID=@Model.UserID&studentID=" + studentID + "&isMenu=3");
                showPopupNotification();
            },
        });
    }
</script>

<script type="text/javascript">
    var viewModel = kendo.observable({
        boxChecked: false,

        GetCheck: function (e) {
            NestedFunc();
        }
    });

    function NestedFunc() {
        var statu = viewModel.get("boxChecked");
        if (statu == true) {
            document.getElementById('dividedAmount').innerHTML = '@ESCHOOL.Resources.Resource.SinglePaymentAmount';
            document.getElementById('amount2').value = div2TotalInstallment();
        }
        else {
            document.getElementById('dividedAmount').innerHTML = '@ESCHOOL.Resources.Resource.DividedAmount';
        }
    }

    $(function () {
        window.kendo.bind($("#singlePaymentDiv"), viewModel);
    });
</script>

<script>
    function div2TotalInstallment() {
        var total = 0;
        var $grid = $('#gridInstallments');
        var kendo = $grid.data().kendoGrid;
        var data = kendo.dataSource.data();
        var amount = 0;
        var payment = 0;
        for (var i = 0; i < data.length; i++) {
            amount = parseFloat(data[i].installmentAmount);
            payment = parseFloat(data[i].previousPayment);

            total += amount - payment;
        }
        document.getElementById("maxTotal").value = total;
        return total;
    }

</script>
<!--#endregion -->


<script>
    function onChangeP(arg) {
        var ID = document.getElementById("studentID").value;

        var grid = $("#gridStudentPeriods").data("kendoGrid");
        var selectedItem = grid.dataItem(grid.select());
        var selection = grid.select();
        var rowData = grid.dataItem(selection);
        var period = rowData.period;

        $.ajax({
            type: "POST",
            url: "/M300Collections/SchoolDebtDataRead/" + "@Model.UserID" + "/" + period + "/" + ID,
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                var grid = $("#gridFees").data("kendoGrid");
                var dataSource = new kendo.data.DataSource({ data: result });
                grid.setDataSource(dataSource);
            },
        });

        $.ajax({
            type: "POST",
            url: '/M300Collections/InstallmentDataRead/' + "@Model.UserID" + "/" + period + "/" + ID,
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                var grid = $("#gridInstallments").data("kendoGrid");
                var dataSource = new kendo.data.DataSource({ data: result });
                grid.setDataSource(dataSource);
            },
        });
        if (ID > 0) {
            $.ajax({
                type: "POST",
                url: "/M300Collections/StudentTempRead?schoolID=" + "@Model.SchoolID" + "&studentID=" + ID + "&period=" + period + "&schoolID=" + "@Model.SchoolID",
                dataType: "json",
                success: function (result) {
                    var combobox = $("#accountCode").data("kendoMultiColumnComboBox");
                    combobox.select(function (dataItem) {
                        return dataItem.name = result.accountCode;
                    });
                    document.getElementById("accountExplanation").value = result.accountExplanation;
                    document.getElementById('isFormPrint').checked = result.isFormPrint;
                },
            });
        }

        var grid = $("#gridPayments").data("kendoGrid");
        grid.dataSource.options.transport.read.url = "/M300Collections/PaymentsDataRead/" + "@Model.UserID" + "/" + period + "/" + ID;
        grid.dataSource.read();
        grid.refresh();

    };

    $(document).ready(function () {
        var ID = document.getElementById("studentID").value;
        var crudServiceBaseUrl = "/M300Collections/",
            dataSource = new kendo.data.DataSource({
                transport: {
                    read: {
                        url: crudServiceBaseUrl + "StudentPeriodsDataRead/" + "@Model.UserID" + "/" + ID,
                        dataType: "json"
                    },
                    parameterMap: function (options, operation) {
                        if (operation !== "read" && options.models) {
                            return { models: kendo.stringify(options.models) };
                        }
                    }
                },
                batch: true,
                schema: {
                    model: {
                        id: "studentPeriodID",
                        fields: {
                            period: { editable: false, type: "string" },
                            classroomName: { editable: false, type: "string" }
                        }
                    }
                }
                //aggregate: [{ field: "feeName", aggregate: "count" },
                //{ field: "balance", aggregate: "sum" }]
            });

        $("#gridStudentPeriods").kendoGrid({
            dataSource: dataSource,
            pageable: false,
            resizable: true,
            height: 135,
            selectable: 'row',
            change: onChangeP,
            ajax: true,
            columns: [
                { field: "period", title: "@ESCHOOL.Resources.Resource.Period", width: "65px", template: '<span style="font-weight: 600;">#= period #</span>' },
                { field: "classroomName", title: "@ESCHOOL.Resources.Resource.Classroom", width: "75px", template: "#=classroomName#" },
                { field: "debt", title: "@ESCHOOL.Resources.Resource.Debt", template: "#if(debt === 0){#  #}else{# #=kendo.toString(debt, 'n')# #}#", aggregates: ["sum"], footerTemplate: "<div style='text-align: right'>#= kendo.toString(data.debt.sum,'n') # </div>", width: "80px", attributes: { style: "text-align:right" } },
                { field: "payment", title: "@ESCHOOL.Resources.Resource.Payment", template: "#if(payment === 0){#  #}else{# #=kendo.toString(payment, 'n')# #}#", aggregates: ["sum"], footerTemplate: "<div style='text-align: right'>#= kendo.toString(data.payment.sum,'n') # </div>", width: "80px", attributes: { style: "text-align:right" } },
                { field: "balance", title: "@ESCHOOL.Resources.Resource.BalanceAmount", template: "#if(balance === 0){#  #}else{# #=kendo.toString(balance, 'n')# #}#", aggregates: ["sum"], footerTemplate: "<div style='text-align: right'>#= kendo.toString(data.balance.sum,'n') # </div>", width: "80px", attributes: { style: "text-align:right" } },
            ],
            // editable: true,
            editable: "inline",
        });
    })
</script>

<script>
    function onChangeSiblings(arg) {
        var grid = $("#gridSiblings").data("kendoGrid");
        var selectedItem = grid.dataItem(grid.select());

        var filename = document.getElementById('imgpreviewStudent').value;
        filename = selectedItem.studentPicture;
        var studentID = selectedItem.studentID

        displayLoading("#gridStudents");
        var grid = $("#gridStudents").data("kendoGrid");
        grid.dataSource.options.transport.read.url = "/M300Collections/GridSiblingDataRead1/" + "@Model.UserID" + "/" + studentID + "/" + "false";
        grid.dataSource.read();
        grid.refresh();

        function displayLoading(target) {
            var element = $(target);
            kendo.ui.progress(element, true);
            setTimeout(function () {
                kendo.ui.progress(element, false);
            }, 1000);
        }
    }

    var check = false;
    var isSelect = false;
    var record1 = 0;
    $(document).ready(function () {
        var crudServiceBaseUrl = "/M300Collections/",
            dataSource = new kendo.data.DataSource({
                transport: {
                    read: {
                        url: crudServiceBaseUrl + "GridStudentDataRead/" + "@Model.UserID" + "/" + "false" + "/" + "true" + "/" + "false",
                        dataType: "json"
                    },
                    parameterMap: function (options, operation) {
                        if (operation !== "read" && options.models) {
                            return { models: kendo.stringify(options.models) };
                        }
                    }
                },
                batch: true,
                schema: {
                    model: {
                        id: "viewModelId",
                        fields: {
                            viewModelId: { editable: false, type: "number" },
                            name: { editable: false, type: "string" },
                            statuCategory: { editable: false, type: "string" },
                            registrationTypeCategory: { editable: false, type: "string" },
                            dateOfRegistration: { editable: false, type: "date", format: "{0:yyyy-MM-dd HH:mm:ss}" },
                            studentPicture: { editable: false, type: "string" },
                        }
                    }
                },
            });

        var first = 1;
        var grid = $("#gridSiblings").kendoGrid({
            dataSource: dataSource,
            sortable: {
                mode: "single",
                allowUnsort: false
            },
            //autoBind: false,
            resizable: true,
            selectable: 'row',
            change: onChangeSiblings,
            toolbar: [
                { template: kendo.template($("#templateSibling").html()) }
            ],
            columns: [
                {
                    template:
                        "<div class='customer-photo'" +
                        "style='background-image: url(../Upload/Students//#:studentPicture#); width: 28px;'></div>",
                },
                { field: "name", title: "@ESCHOOL.Resources.Resource.StudentName", footerTemplate: "#= sumStudentSibling(1) #", width: "170px", },
                { field: "studentClassroom", title: "@ESCHOOL.Resources.Resource.Classrooms", width: "100px" },
                { field: "balance", title: "@ESCHOOL.Resources.Resource.BalanceAmount", template: "#if(balance === 0){#  #}else{# #=kendo.toString(balance, 'n')# #}#", aggregates: ["sum"], footerTemplate: "<div style='text-align: right'>#= kendo.toString(data.balance.sum,'n') # </div>", width: "110px", attributes: { style: "text-align:right" } },
                { field: "statuCategory" },
                { field: "registrationTypeCategory" },
                { field: "studentPicture" },
            ],
            //dataBound: function (e) {
            //    //grid.select("tr:eq(0)");
            //    let grid = this;
            //    grid.select("tr:eq(1)");
            //    alert("geldi");
            //},
            dataBinding: function () {
                record = 0;
                //this.trigger('dataBound');
            },
        });
        var grid = $("#gridSiblings").data("kendoGrid");
        grid.hideColumn(4);
        grid.hideColumn(5);
        grid.hideColumn(6);
        //grid.hideColumn(7);
        //grid.hideColumn(8);
    });

    //function showDetails(e) {
    //    e.preventDefault();
    //    var dataItem = this.dataItem($(e.currentTarget).closest("tr"));
    //    window.location.replace("/M210Student/AddOrEditStudent?studentID=" + dataItem.id + "&userID=@Model.UserID");
    //}
    function sumStudentSibling(e) {
        var total = 0;
        var $grid = $('#gridSiblings');
        var kendo = $grid.data().kendoGrid;
        var data = kendo.dataSource.data();
        var amount = 0;
        for (var i = 0; i < data.length; i++) {
            if (e == 1) amount += 1;
            if (amount == NaN) {
                amount = 0;
            }
        }
        total = amount;
        return total;
    }

</script>

<script>
    $(function () {
        $("#switch1").kendoSwitch({
            messages: {
                checked: '<i class="k-icon k-i-list-unordered"></i></i>',
                unchecked: '<i class="fas fa-toggle-off"></i>'
            },
            change: function (e) {
                gridshow();
                if (e.checked == true) {
                    var myWindow = $("#periods").show(500);
                    document.getElementById('switchId1').value = 1;
                }
                else {
                    var myWindow = $("#periods").hide(500);
                    document.getElementById('switchId1').value = 0;
                }
            }
        });
    })
</script>
<script>
    $(function () {
        $("#switch2").kendoSwitch({
            messages: {
                checked: '<i class="fas fa-user-friends"></i></i>',
                unchecked: '<i class="fas fa-toggle-off"></i>'
            },
            change: function (e) {
                gridshow();
                if (e.checked == true) {
                    var myWindow = $("#siblings").show(500);
                    document.getElementById('switchId2').value = 1;
                    refreshIdDisabled();
                    var grid = $("#gridSiblings").data("kendoGrid");
                    grid.select("tr:eq(0)");
                }
                else {
                    var myWindow = $("#siblings").hide(500);
                    document.getElementById('switchId2').value = 0;
                    refreshIdEnabled();
                }
            },
        });
    })

    $(function () {
        $("#switch22").kendoSwitch({
            messages: {
                checked: '<i class="k-icon k-i-list-unordered"></i></i>',
                unchecked: '<i class="fas fa-toggle-off"></i>'
            },
            change: function (e) {
                //gridshow();
                if (e.checked == true) {
                    var grid = $("#gridSiblings").data("kendoGrid");
                    var selectedItem = grid.dataItem(grid.select());
                    var studentID = selectedItem.studentID

                    var grid = $("#gridStudents").data("kendoGrid");
                    grid.dataSource.options.transport.read.url = "/M300Collections/GridSiblingDataRead1/" + "@Model.UserID" + "/" + studentID + "/" + "true";
                    grid.dataSource.read();
                    grid.refresh();
                }
                else {
                    var grid = $("#gridSiblings").data("kendoGrid");
                    var selectedItem = grid.dataItem(grid.select());
                    var studentID = selectedItem.studentID

                    var grid = $("#gridStudents").data("kendoGrid");
                    grid.dataSource.options.transport.read.url = "/M300Collections/GridSiblingDataRead1/" + "@Model.UserID" + "/" + studentID + "/" + "false";
                    grid.dataSource.read();
                    grid.refresh();
                }
            },
        });
    })
</script>
<script>
    function refreshIdEnabled() {
        var sw = document.getElementById('switchId2').value;
        if (sw == 0) {
            document.getElementById("refreshId").disabled = true;

            setTimeout(function () {
                studentsRefresh();
            }, 500);
        }
    }
</script>
<script>
    function refreshIdDisabled() {
        document.getElementById("refreshId").disabled = false;
    }
</script>

<script>
    function gridshow() {
        var studentID = document.getElementById("studentID").value;
        $.ajax({
            type: "POST",
            url: '/M300Collections/StudentPeriodsDataRead/' + "@Model.UserID" + "/" + studentID,
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                var grid = $("#gridStudentPeriods").data("kendoGrid");
                var dataSource = new kendo.data.DataSource({ data: result });
                grid.setDataSource(dataSource);
            },
        });
    };
</script>

<script>
    function waitProgress() {
        $('#loader-pulsing').kendoLoader({ type: 'pulsing' });
        $('#loader-infinite-spinner').kendoLoader({ type: 'infinite-spinner' });
        $('#loader-converging-spinner').kendoLoader({ type: 'converging-spinner' });
    }
</script>
<div class="vertical-center">
    <span id="loader-pulsing"></span>
    <span id="loader-infinite-spinner"></span>
    <span id="loader-converging-spinner"></span>
</div>
<style>
    .vertical-center {
        margin: 0;
        position: absolute;
        top: 50%;
        left: 50%;
        -ms-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
    }
</style>
<script>
    $("#wrap img").hover(function () {
        kendo.fx(this).zoom("in").startValue(1).endValue(1.3).play();
    }, function () {
        kendo.fx(this).zoom("out").endValue(1).startValue(1.3).play();
    });

    $("#divheader").show(1000);
</script>
<script>
    window.history.replaceState('', '', window.location.pathname);
</script>
